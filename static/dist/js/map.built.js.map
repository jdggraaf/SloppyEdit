{"version":3,"sources":["../../js/map.js"],"names":["$selectExclude","$selectPokemonNotify","$selectRarityNotify","$textPerfectionNotify","$selectStyle","$selectIconResolution","$selectIconSize","$selectOpenGymsOnly","$selectTeamGymsOnly","$selectLastUpdateGymsOnly","$selectMinGymLevel","$selectMaxGymLevel","$selectLuredPokestopsOnly","$selectSearchIconMarker","$selectGymMarkerStyle","$selectLocationIconMarker","$switchGymSidebar","language","document","documentElement","lang","idToPokemon","i8lnDictionary","languageLookups","languageLookupThreshold","searchMarkerStyles","timestamp","excludedPokemon","notifiedPokemon","notifiedRarity","notifiedMinPerfection","onlyPokemon","buffer","reincludedPokemon","reids","map","rawDataIsLoading","locationMarker","rangeMarkers","searchMarker","storeZoom","scanPath","moves","oSwLat","oSwLng","oNeLat","oNeLng","lastpokestops","lastgyms","lastpokemon","lastslocs","lastspawns","selectedStyle","updateWorker","lastUpdateTime","gymTypes","gymPrestige","audio","Audio","genderType","unownForm","notifyIvTitle","notifyNoIvTitle","notifyText","excludePokemon","id","val","concat","trigger","notifyAboutPokemon","removePokemonMarker","encounterId","mapData","pokemons","marker","rangeCircle","setMap","hidden","initMap","google","maps","Map","getElementById","center","lat","centerLat","lng","centerLng","zoom","Store","get","fullscreenControl","streetViewControl","mapTypeControl","clickableIcons","mapTypeControlOptions","style","MapTypeControlStyle","DROPDOWN_MENU","position","ControlPosition","RIGHT_TOP","mapTypeIds","MapTypeId","ROADMAP","SATELLITE","HYBRID","styleNoLabels","StyledMapType","noLabelsStyle","name","mapTypes","set","styleDark","darkStyle","styleLight2","light2Style","stylePgo","pGoStyle","styleDarkNl","darkStyleNoLabels","styleLight2Nl","light2StyleNoLabels","stylePgoNl","pGoStyleNoLabels","stylePgoDay","pGoStyleDay","stylePgoNight","pGoStyleNight","currentDate","Date","currentHour","getHours","stylePgoDynamic","addListener","s","mapTypeId","setMapTypeId","updateMap","getZoom","redrawPokemon","lurePokemons","createSearchMarker","createLocationMarker","createMyLocationButton","initSidebar","$","on","loc","getCenter","changeLocation","checked","prop","searchControl","updateLocationMarker","setIcon","icon","Marker","animation","Animation","DROP","draggable","optimized","zIndex","MAX_ZINDEX","infoWindow","InfoWindow","content","disableAutoPan","addListeners","event","newLocation","getPosition","updateSearchMarker","oldLocation","changeSearchLocation","done","fail","setPosition","searchControlURI","action","post","encodeURIComponent","toggleClass","updateSearchStatus","getJSON","then","data","status","toggle","searchBox","places","Autocomplete","css","length","setInterval","place","getPlace","geometry","location","icons","each","pokemonSprites","key","value","append","attr","text","pad","number","slice","getTypeSpan","type","openMapDirections","url","window","open","toggleOtherPokemon","pokemonId","clearStaleMarkers","getDateStr","t","dateStr","moment","format","scout","encounterIdLong","atob","infoEl","ivEl","movesEl","genderEl","cpEl","probsEl","ajax","dataType","cache","beforeSend","show","error","success","textStatus","jqXHR","after","buildIVDiv","iv_attack","iv_defense","iv_stamina","buildCPDiv","cp","level","pMove1","move_1","undefined","i8ln","pMove2","move_2","buildMovesDiv","rating_attack","rating_defense","buildGenderDiv","weight","height","gender","buildProbsDiv","catch_prob_1","catch_prob_2","catch_prob_3","hide","pkm","atk","def","sta","iv","getIv","toFixed","ratingAttack","ratingDefense","prob1","prob2","prob3","pokemonLabel","item","rarityDisplay","types","typesDisplay","latitude","longitude","disappearTime","disappearDate","form","index","details","scoutLink","contentstring","getMinutes","getSeconds","gymLabel","teamName","teamId","gymPoints","lastScanned","lastModified","members","gymId","memberStr","i","pokemon_name","trainer_name","trainer_level","pokemon_id","pokemon_cp","lastScannedStr","lastModifiedStr","directionsStr","nameStr","gymColor","str","gymLevel","getGymLevel","points","pokestopLabel","expireTime","expireDate","formatSpawnTime","seconds","Math","floor","substr","spawnpointLabel","time","special","addRangeCircle","targetmap","circleCenter","LatLng","gymColors","teamColor","range","circleColor","rangeCircleOpts","radius","strokeWeight","strokeColor","strokeOpacity","fillColor","fillOpacity","Circle","isRangeActive","stm","lpad","len","padstr","Array","max","String","join","repArray","find","replace","getTimeUntil","now","tdiff","sec","min","hour","getNotifyText","ntitle","dist","toLocaleString","minute","second","hour12","until","udist","ntext","customizePokemonMarker","skipNotification","setAnimation","animationDisabled","indexOf","play","sendNotification","fav_title","fav_text","BOUNCE","perfection","setupGymMarker","scaledSize","Size","gymSidebar","querySelector","getAttribute","classList","contains","remove","setAttribute","showGymDetails","persist","isMobileDevice","isTouchDevice","clearSelection","updateLabelDiffTime","close","updateGymMarker","setContent","updateGymIcons","gyms","setupPokestopMarker","imagename","getColorByDate","diff","hue","toString","setupScannedMarker","clickable","getColorBySpawnTime","round","changeSpawnIcon","color","urlColor","zoomScale","minimumSize","newSize","newIcon","anchor","Point","spawnPointIndex","newIndex","scale","setupSpawnpointMarker","selection","empty","getSelection","removeAllRanges","infoWindowIsOpen","isTemporaryHidden","getTime","scanned","showInBoundsMarkers","markers","getBounds","intersects","team_id","getMap","oldAnimation","getAnimation","loadRawData","loadPokemon","loadGyms","loadPokestops","loadScanned","loadSpawnpoints","loadLuredOnly","Boolean","bounds","swPoint","getSouthWest","nePoint","getNorthEast","swLat","swLng","neLat","neLng","toastr","options","complete","processPokemons","setupPokemonMarker","processPokestops","pokestops","item2","updatePokestops","removeStops","currentTime","push","processGyms","gym_points","removeGymFromMap","gymid","gymHasOpenSpot","pokemonInGym","pokemon","closePrestige","last_scanned","processScanned","scanId","last_modified","updateScanned","setOptions","processSpawnpoints","spawnpoints","updateSpawnPoints","setZIndex","result","hasClass","countMarkers","ad","filter","e","drawScanPath","scanPathPoints","idx","point","Polyline","path","geodesic","pokemonList","newMarker","element","disappearsAt","parseInt","hours","minutes","timestring","ttime","getPointDistance","pointA","pointB","spherical","computeDistanceBetween","title","Notification","permission","requestPermission","notification","body","sound","onclick","focus","centerMap","locationContainer","createElement","locationButton","backgroundColor","border","outline","width","borderRadius","boxShadow","cursor","marginRight","padding","appendChild","locationIcon","margin","backgroundImage","backgroundSize","backgroundPosition","backgroundRepeat","addEventListener","centerMapOnLocation","controls","RIGHT_BOTTOM","currentLocation","imgX","animationInterval","navigator","geolocation","getCurrentPosition","latlng","coords","setCenter","clearInterval","setZoom","word","isEmptyObject","async","console","log","updateGeoLocation","panTo","createUpdateWorker","Worker","updateBlob","Blob","updateBlobURL","URL","createObjectURL","onmessage","postMessage","ex","message","sidebar","sidebarClose","add","nextLvlPrestige","prestigePercentage","lastScannedDateStr","lastModifiedDateStr","freeSlots","freeSlotsStr","gymLevelStr","pokemonHtml","headerHtml","perfectPercent","moveEnergy","move_2_energy","move_1_name","move_1_type","toLowerCase","move_1_damage","move_2_name","move_2_type","move_2_damage","guard_pokemon_id","guard_pokemon_name","innerHTML","href","className","tabIndex","preventDefault","stopPropagation","toggleGymPokemonDetails","lastElementChild","firstElementChild","nextElementSibling","styleList","select2","placeholder","minimumResultsForSearch","Infinity","d","dType","searchMarkerStyleList","selectSearchIconMarker","formatState","state","$state","numberOfPokemon","pokeList","_types","pokemonType","templateResult","Number","isNaN","buildSwitchChangeListener","storageKey","change","wrapper","wrapper2","bind","setDraggable","alert","accordion","active","collapsible","heightStyle","DataTable","paging","searching","info","errMode","order"],"mappings":"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","file":"map.built.js","sourcesContent":["//\n// Global map.js variables\n//\n\nvar $selectExclude\nvar $selectPokemonNotify\nvar $selectRarityNotify\nvar $textPerfectionNotify\nvar $selectStyle\nvar $selectIconResolution\nvar $selectIconSize\nvar $selectOpenGymsOnly\nvar $selectTeamGymsOnly\nvar $selectLastUpdateGymsOnly\nvar $selectMinGymLevel\nvar $selectMaxGymLevel\nvar $selectLuredPokestopsOnly\nvar $selectSearchIconMarker\nvar $selectGymMarkerStyle\nvar $selectLocationIconMarker\nvar $switchGymSidebar\n\nvar language = document.documentElement.lang === '' ? 'en' : document.documentElement.lang\nvar idToPokemon = {}\nvar i8lnDictionary = {}\nvar languageLookups = 0\nvar languageLookupThreshold = 3\n\nvar searchMarkerStyles\n\nvar timestamp\nvar excludedPokemon = []\nvar notifiedPokemon = []\nvar notifiedRarity = []\nvar notifiedMinPerfection = null\nvar onlyPokemon = 0\n\nvar buffer = []\nvar reincludedPokemon = []\nvar reids = []\n\nvar map\nvar rawDataIsLoading = false\nvar locationMarker\nvar rangeMarkers = ['pokemon', 'pokestop', 'gym']\nvar searchMarker\nvar storeZoom = true\nvar scanPath\nvar moves\n\nvar oSwLat\nvar oSwLng\nvar oNeLat\nvar oNeLng\n\nvar lastpokestops\nvar lastgyms\nvar lastpokemon\nvar lastslocs\nvar lastspawns\n\nvar selectedStyle = 'light'\n\nvar updateWorker\nvar lastUpdateTime\n\nvar gymTypes = ['Uncontested', 'Mystic', 'Valor', 'Instinct']\nvar gymPrestige = [2000, 4000, 8000, 12000, 16000, 20000, 30000, 40000, 50000]\nvar audio = new Audio('static/sounds/ding.mp3')\n\nvar genderType = ['', '', '']\nvar unownForm = ['unset', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '!', '?']\n\n\n/*\n  text place holders:\n  <pkm> - pokemon name\n  <prc> - iv in percent without percent symbol\n  <atk> - attack as number\n  <def> - defense as number\n  <sta> - stamnia as number\n*/\nvar notifyIvTitle = '<pkm> <prc>% (<atk>/<def>/<sta>)'\nvar notifyNoIvTitle = '<pkm>'\n\n/*\n  text place holders:\n  <dist>  - disappear time\n  <udist> - time until disappear\n*/\nvar notifyText = 'disappears at <dist> (<udist>)'\n\n//\n// Functions\n//\n\nfunction excludePokemon(id) { // eslint-disable-line no-unused-vars\n    $selectExclude.val(\n        $selectExclude.val().concat(id)\n    ).trigger('change')\n}\n\nfunction notifyAboutPokemon(id) { // eslint-disable-line no-unused-vars\n    $selectPokemonNotify.val(\n        $selectPokemonNotify.val().concat(id)\n    ).trigger('change')\n}\n\nfunction removePokemonMarker(encounterId) { // eslint-disable-line no-unused-vars\n    if (mapData.pokemons[encounterId].marker.rangeCircle) {\n        mapData.pokemons[encounterId].marker.rangeCircle.setMap(null)\n        delete mapData.pokemons[encounterId].marker.rangeCircle\n    }\n    mapData.pokemons[encounterId].marker.setMap(null)\n    mapData.pokemons[encounterId].hidden = true\n}\n\nfunction initMap() { // eslint-disable-line no-unused-vars\n    map = new google.maps.Map(document.getElementById('map'), {\n        center: {\n            lat: centerLat,\n            lng: centerLng\n        },\n        zoom: Store.get('zoomLevel'),\n        fullscreenControl: true,\n        streetViewControl: false,\n        mapTypeControl: false,\n        clickableIcons: false,\n        mapTypeControlOptions: {\n            style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,\n            position: google.maps.ControlPosition.RIGHT_TOP,\n            mapTypeIds: [\n                google.maps.MapTypeId.ROADMAP,\n                google.maps.MapTypeId.SATELLITE,\n                google.maps.MapTypeId.HYBRID,\n                'nolabels_style',\n                'dark_style',\n                'style_light2',\n                'style_pgo',\n                'dark_style_nl',\n                'style_light2_nl',\n                'style_pgo_nl',\n                'style_pgo_day',\n                'style_pgo_night',\n                'style_pgo_dynamic'\n            ]\n        }\n    })\n\n    var styleNoLabels = new google.maps.StyledMapType(noLabelsStyle, {\n        name: 'No Labels'\n    })\n    map.mapTypes.set('nolabels_style', styleNoLabels)\n\n    var styleDark = new google.maps.StyledMapType(darkStyle, {\n        name: 'Dark'\n    })\n    map.mapTypes.set('dark_style', styleDark)\n\n    var styleLight2 = new google.maps.StyledMapType(light2Style, {\n        name: 'Light2'\n    })\n    map.mapTypes.set('style_light2', styleLight2)\n\n    var stylePgo = new google.maps.StyledMapType(pGoStyle, {\n        name: 'RocketMap'\n    })\n    map.mapTypes.set('style_pgo', stylePgo)\n\n    var styleDarkNl = new google.maps.StyledMapType(darkStyleNoLabels, {\n        name: 'Dark (No Labels)'\n    })\n    map.mapTypes.set('dark_style_nl', styleDarkNl)\n\n    var styleLight2Nl = new google.maps.StyledMapType(light2StyleNoLabels, {\n        name: 'Light2 (No Labels)'\n    })\n    map.mapTypes.set('style_light2_nl', styleLight2Nl)\n\n    var stylePgoNl = new google.maps.StyledMapType(pGoStyleNoLabels, {\n        name: 'RocketMap (No Labels)'\n    })\n    map.mapTypes.set('style_pgo_nl', stylePgoNl)\n\n    var stylePgoDay = new google.maps.StyledMapType(pGoStyleDay, {\n        name: 'RocketMap Day'\n    })\n    map.mapTypes.set('style_pgo_day', stylePgoDay)\n\n    var stylePgoNight = new google.maps.StyledMapType(pGoStyleNight, {\n        name: 'RocketMap Night'\n    })\n    map.mapTypes.set('style_pgo_night', stylePgoNight)\n\n    // dynamic map style chooses stylePgoDay or stylePgoNight depending on client time\n    var currentDate = new Date()\n    var currentHour = currentDate.getHours()\n    var stylePgoDynamic = (currentHour >= 6 && currentHour < 19) ? stylePgoDay : stylePgoNight\n    map.mapTypes.set('style_pgo_dynamic', stylePgoDynamic)\n\n    map.addListener('maptypeid_changed', function (s) {\n        Store.set('map_style', this.mapTypeId)\n    })\n\n    map.setMapTypeId(Store.get('map_style'))\n    map.addListener('idle', updateMap)\n\n    map.addListener('zoom_changed', function () {\n        if (storeZoom === true) {\n            Store.set('zoomLevel', this.getZoom())\n        } else {\n            storeZoom = true\n        }\n\n        redrawPokemon(mapData.pokemons)\n        redrawPokemon(mapData.lurePokemons)\n    })\n\n    searchMarker = createSearchMarker()\n    locationMarker = createLocationMarker()\n    createMyLocationButton()\n    initSidebar()\n\n    $('#scan-here').on('click', function () {\n        var loc = map.getCenter()\n        changeLocation(loc.lat(), loc.lng())\n\n        if (!$('#search-switch').checked) {\n            $('#search-switch').prop('checked', true)\n            searchControl('on')\n        }\n    })\n}\n\nfunction updateLocationMarker(style) {\n    if (style in searchMarkerStyles) {\n        locationMarker.setIcon(searchMarkerStyles[style].icon)\n        Store.set('locationMarkerStyle', style)\n    }\n    return locationMarker\n}\n\nfunction createLocationMarker() {\n    var position = Store.get('followMyLocationPosition')\n    var lat = ('lat' in position) ? position.lat : centerLat\n    var lng = ('lng' in position) ? position.lng : centerLng\n\n    var locationMarker = new google.maps.Marker({\n        map: map,\n        animation: google.maps.Animation.DROP,\n        position: {\n            lat: lat,\n            lng: lng\n        },\n        draggable: true,\n        icon: null,\n        optimized: false,\n        zIndex: google.maps.Marker.MAX_ZINDEX + 2\n    })\n\n    locationMarker.infoWindow = new google.maps.InfoWindow({\n        content: '<div><b>My Location</b></div>',\n        disableAutoPan: true\n    })\n\n    addListeners(locationMarker)\n\n    google.maps.event.addListener(locationMarker, 'dragend', function () {\n        var newLocation = locationMarker.getPosition()\n        Store.set('followMyLocationPosition', {\n            lat: newLocation.lat(),\n            lng: newLocation.lng()\n        })\n    })\n\n    return locationMarker\n}\n\nfunction updateSearchMarker(style) {\n    if (style in searchMarkerStyles) {\n        searchMarker.setIcon(searchMarkerStyles[style].icon)\n        Store.set('searchMarkerStyle', style)\n    }\n\n    return searchMarker\n}\n\nfunction createSearchMarker() {\n    var searchMarker = new google.maps.Marker({ // need to keep reference.\n        position: {\n            lat: centerLat,\n            lng: centerLng\n        },\n        map: map,\n        animation: google.maps.Animation.DROP,\n        draggable: !Store.get('lockMarker'),\n        icon: null,\n        optimized: false,\n        zIndex: google.maps.Marker.MAX_ZINDEX + 1\n    })\n\n    searchMarker.infoWindow = new google.maps.InfoWindow({\n        content: '<div><b>Search Location</b></div>',\n        disableAutoPan: true\n    })\n\n    addListeners(searchMarker)\n\n    var oldLocation = null\n    google.maps.event.addListener(searchMarker, 'dragstart', function () {\n        oldLocation = searchMarker.getPosition()\n    })\n\n    google.maps.event.addListener(searchMarker, 'dragend', function () {\n        var newLocation = searchMarker.getPosition()\n        changeSearchLocation(newLocation.lat(), newLocation.lng())\n            .done(function () {\n                oldLocation = null\n            })\n            .fail(function () {\n                if (oldLocation) {\n                    searchMarker.setPosition(oldLocation)\n                }\n            })\n    })\n\n    return searchMarker\n}\n\nvar searchControlURI = 'search_control'\n\nfunction searchControl(action) {\n    $.post(searchControlURI + '?action=' + encodeURIComponent(action))\n    $('#scan-here').toggleClass('disabled', action === 'off')\n}\n\nfunction updateSearchStatus() {\n    $.getJSON(searchControlURI).then(function (data) {\n        $('#search-switch').prop('checked', data.status)\n        $('#scan-here').toggleClass('disabled', !data.status)\n    })\n}\n\nfunction initSidebar() {\n    $('#gyms-switch').prop('checked', Store.get('showGyms'))\n    $('#gym-sidebar-switch').prop('checked', Store.get('useGymSidebar'))\n    $('#gym-sidebar-wrapper').toggle(Store.get('showGyms'))\n    $('#gyms-filter-wrapper').toggle(Store.get('showGyms'))\n    $('#team-gyms-only-switch').val(Store.get('showTeamGymsOnly'))\n    $('#open-gyms-only-switch').val(Store.get('showOpenGymsOnly'))\n    $('#min-level-gyms-filter-switch').val(Store.get('minGymLevel'))\n    $('#max-level-gyms-filter-switch').val(Store.get('maxGymLevel'))\n    $('#last-update-gyms-switch').val(Store.get('showLastUpdatedGymsOnly'))\n    $('#pokemon-switch').prop('checked', Store.get('showPokemon'))\n    $('#pokestops-switch').prop('checked', Store.get('showPokestops'))\n    $('#lured-pokestops-only-switch').val(Store.get('showLuredPokestopsOnly'))\n    $('#lured-pokestops-only-wrapper').toggle(Store.get('showPokestops'))\n    $('#geoloc-switch').prop('checked', Store.get('geoLocate'))\n    $('#lock-marker-switch').prop('checked', Store.get('lockMarker'))\n    $('#start-at-user-location-switch').prop('checked', Store.get('startAtUserLocation'))\n    $('#follow-my-location-switch').prop('checked', Store.get('followMyLocation'))\n    $('#scan-here-switch').prop('checked', Store.get('scanHere'))\n    $('#scan-here').toggle(Store.get('scanHere'))\n    $('#scanned-switch').prop('checked', Store.get('showScanned'))\n    $('#spawnpoints-switch').prop('checked', Store.get('showSpawnpoints'))\n    $('#ranges-switch').prop('checked', Store.get('showRanges'))\n    $('#sound-switch').prop('checked', Store.get('playSound'))\n    var searchBox = new google.maps.places.Autocomplete(document.getElementById('next-location'))\n    $('#next-location').css('background-color', $('#geoloc-switch').prop('checked') ? '#e0e0e0' : '#ffffff')\n\n    if ($('#search-switch').length) {\n        updateSearchStatus()\n        setInterval(updateSearchStatus, 5000)\n    }\n\n    searchBox.addListener('place_changed', function () {\n        var place = searchBox.getPlace()\n\n        if (!place.geometry) return\n\n        var loc = place.geometry.location\n        changeLocation(loc.lat(), loc.lng())\n    })\n    var icons = $('#pokemon-icons')\n    $.each(pokemonSprites, function (key, value) {\n        icons.append($('<option></option>').attr('value', key).text(value.name))\n    })\n    icons.val((pokemonSprites[Store.get('pokemonIcons')]) ? Store.get('pokemonIcons') : 'highres')\n    $('#pokemon-icon-size').val(Store.get('iconSizeModifier'))\n}\n\nfunction pad(number) {\n    return number <= 99 ? ('0' + number).slice(-2) : number\n}\n\nfunction getTypeSpan(type) {\n    return `<span style='padding: 2px 5px; text-transform: uppercase; color: white; margin-right: 2px; border-radius: 4px; font-size: 0.8em; vertical-align: text-bottom; background-color: ${type['color']}'>${type['type']}</span>`\n}\n\nfunction openMapDirections(lat, lng) { // eslint-disable-line no-unused-vars\n    var url = 'https://www.google.com/maps/?daddr=' + lat + ',' + lng\n    window.open(url, '_blank')\n}\n\nfunction toggleOtherPokemon(pokemonId) {\n    onlyPokemon = onlyPokemon === 0 ? pokemonId : 0\n    if (onlyPokemon === 0) {\n        // reload all Pokemon\n        lastpokemon = false\n        updateMap()\n    } else {\n        // remove other Pokemon\n        clearStaleMarkers()\n    }\n}\n\n\n// Converts timestamp to readable String\nfunction getDateStr(t) {\n    var dateStr = 'Unknown'\n    if (t) {\n        dateStr = moment(t).format('YYYY-MM-DD HH:mm:ss')\n    }\n    return dateStr\n}\n\nfunction scout(encounterId) { // eslint-disable-line no-unused-vars\n    var encounterIdLong = atob(encounterId)\n    var infoEl = $('#scoutInfo' + encounterIdLong)\n    var ivEl = $('#pkmIV' + encounterIdLong)\n    var movesEl = $('#pkmMoves' + encounterIdLong)\n    var genderEl = $('#pkmGender' + encounterIdLong)\n    var cpEl = $('#pkmCP' + encounterIdLong)\n    var probsEl = $('#pkmProbs' + encounterIdLong)\n\n    $.ajax({\n        url: 'scout',\n        type: 'GET',\n        data: {\n            'encounter_id': encounterId\n        },\n        dataType: 'json',\n        cache: false,\n        beforeSend: function () {\n            infoEl.text('Scouting, please wait...')\n            infoEl.show()\n        },\n        error: function () {\n            infoEl.text('Error scouting, try again?')\n        },\n        success: function (data, textStatus, jqXHR) {\n            if (data.success) {\n                if (ivEl.length === 0) {\n                    $('#pkmLoc' + encounterIdLong).after(buildIVDiv(encounterIdLong, data.iv_attack, data.iv_defense, data.iv_stamina))\n                    ivEl = $('#pkmIV' + encounterIdLong)\n                }\n                if (cpEl.length === 0) {\n                    ivEl.after(buildCPDiv(encounterIdLong, data.cp, data.level))\n                    cpEl = $('#pkmCP' + encounterIdLong)\n                }\n                if (movesEl.length === 0) {\n                    var pMove1 = (moves[data.move_1] !== undefined) ? i8ln(moves[data.move_1]['name']) : 'gen/unknown'\n                    var pMove2 = (moves[data.move_2] !== undefined) ? i8ln(moves[data.move_2]['name']) : 'gen/unknown'\n                    cpEl.after(buildMovesDiv(encounterIdLong, pMove1, pMove2, data.rating_attack, data.rating_defense))\n                    movesEl = $('#pkmMoves' + encounterIdLong)\n                }\n                if (genderEl.length === 0) {\n                    movesEl.after(buildGenderDiv(encounterIdLong, data.weight, data.height, data.gender))\n                    genderEl = $('#pkmGender' + encounterIdLong)\n                }\n                if (probsEl.length === 0) {\n                    genderEl.after(buildProbsDiv(encounterIdLong, data.catch_prob_1, data.catch_prob_2, data.catch_prob_3))\n                }\n                infoEl.hide()\n\n                // update local values\n                var pkm = mapData.pokemons[encounterId]\n                pkm['individual_attack'] = data.iv_attack\n                pkm['individual_defense'] = data.iv_defense\n                pkm['individual_stamina'] = data.iv_stamina\n                pkm['move_1'] = data.move_1\n                pkm['move_2'] = data.move_2\n                pkm['weight'] = data.weight\n                pkm['height'] = data.height\n                pkm['gender'] = data.gender\n                pkm['cp'] = data.cp\n                pkm['level'] = data.level\n                pkm['catch_prob_1'] = data.catch_prob_1\n                pkm['catch_prob_2'] = data.catch_prob_2\n                pkm['catch_prob_3'] = data.catch_prob_3\n                pkm['rating_attack'] = data.rating_attack\n                pkm['rating_defense'] = data.rating_defense\n            } else {\n                infoEl.text(data.error)\n            }\n        }\n    })\n}\n\nfunction buildIVDiv(encounterIdLong, atk, def, sta) {\n    var iv = getIv(atk, def, sta)\n    return `\n        <div id=\"pkmIV${encounterIdLong}\">\n            IV: <b>${iv.toFixed(1)}%</b> (${atk}/${def}/${sta})\n        </div>\n        `\n}\n\nfunction buildMovesDiv(encounterIdLong, pMove1, pMove2, ratingAttack, ratingDefense) {\n    return `\n        <div id=\"pkmMoves${encounterIdLong}\">\n            Moves: <b>${pMove1}</b> / <b>${pMove2}</b> | Rating: <b title=\"Moveset Attack Rating\">${ratingAttack}</b> / <b title=\"Moveset Defense Rating\">${ratingDefense}</b>\n        </div>\n        `\n}\n\nfunction buildGenderDiv(encounterIdLong, weight, height, gender) {\n    return `\n        <div id=\"pkmGender${encounterIdLong}\">\n            Gender: ${genderType[gender - 1]} | Weight: ${weight.toFixed(2)}kg | Height: ${height.toFixed(2)}m\n        </div>\n        `\n}\n\nfunction buildCPDiv(encounterIdLong, cp, level) {\n    return `\n        <div id=\"pkmCP${encounterIdLong}\">\n            Level: <b title=\"Maximum Level is 30\">${level}</b> | CP: <b>${cp}</b>\n        </div>\n        `\n}\n\nfunction buildProbsDiv(encounterIdLong, prob1, prob2, prob3) {\n    prob1 = prob1 * 100\n    prob2 = prob2 * 100\n    prob3 = prob3 * 100\n    return `\n        <div id=\"pkmProbs${encounterIdLong}\">\n            Pokeball: ${prob1.toFixed(1)}% | Great Ball: ${prob2.toFixed(1)}% | Ultra Ball: ${prob3.toFixed(1)}%\n        </div>\n        `\n}\n\nfunction pokemonLabel(item) {\n    var name = item['pokemon_name']\n    var rarityDisplay = item['pokemon_rarity'] ? '(' + item['pokemon_rarity'] + ')' : ''\n    var types = item['pokemon_types']\n    var typesDisplay = ''\n    var encounterId = item['encounter_id']\n    var id = item['pokemon_id']\n    var latitude = item['latitude']\n    var longitude = item['longitude']\n    var disappearTime = item['disappear_time']\n    var disappearDate = new Date(disappearTime)\n    var atk = item['individual_attack']\n    var def = item['individual_defense']\n    var sta = item['individual_stamina']\n    var pMove1 = (moves[item['move_1']] !== undefined) ? i8ln(moves[item['move_1']]['name']) : 'gen/unknown'\n    var pMove2 = (moves[item['move_2']] !== undefined) ? i8ln(moves[item['move_2']]['name']) : 'gen/unknown'\n    var weight = item['weight']\n    var height = item['height']\n    var gender = item['gender']\n    var form = item['form']\n    var cp = item['cp']\n    var level = item['level']\n    var prob1 = item['catch_prob_1']\n    var prob2 = item['catch_prob_2']\n    var prob3 = item['catch_prob_3']\n    var ratingAttack = item['rating_attack']\n    var ratingDefense = item['rating_defense']\n    var encounterIdLong = atob(encounterId)\n\n    $.each(types, function (index, type) {\n        typesDisplay += getTypeSpan(type)\n    })\n\n    var details = ''\n    if (atk !== null && def !== null && sta !== null) {\n        details += buildIVDiv(encounterIdLong, atk, def, sta)\n    }\n    if (cp != null) {\n        details += buildCPDiv(encounterIdLong, cp, level)\n    }\n    if (pMove1 !== 'gen/unknown') {\n        details += buildMovesDiv(encounterIdLong, pMove1, pMove2, ratingAttack, ratingDefense)\n    }\n    if (gender != null) {\n        details += buildGenderDiv(encounterIdLong, weight, height, gender)\n    }\n    if (prob1 != null) {\n        details += buildProbsDiv(encounterIdLong, prob1, prob2, prob3)\n    }\n    var scoutLink\n    if (cp === null) {\n        scoutLink = `<a href='javascript:void(0);' onclick='javascript:scout(\"${encounterId}\");' title='Scout CP'>Scout</a>&nbsp;&nbsp`\n    } else {\n        scoutLink = ''\n    }\n\n    var contentstring = `\n        <div>\n            <b>${name}</b>`\n    if (id === 201 && form !== null && form > 0) {\n        contentstring += ` (${unownForm[item['form']]})`\n    }\n    contentstring += `<span> - </span>\n            <small>\n                <a href='http://www.pokemon.com/us/pokedex/${id}' target='_blank' title='View in Pokedex'>#${id}</a>\n            </small>\n            <span> ${rarityDisplay}</span>\n            <span> - </span>\n            <small>${typesDisplay}</small>\n        </div>\n        <div>\n            Disappears at ${pad(disappearDate.getHours())}:${pad(disappearDate.getMinutes())}:${pad(disappearDate.getSeconds())}\n            <span class='label-countdown' disappears-at='${disappearTime}'>(00m00s)</span>\n        </div>\n        <div id=\"pkmLoc${encounterIdLong}\">\n            Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n        </div>\n            ${details}\n        <div id=\"scoutInfo${encounterIdLong}\" style=\"display:none;\"></div>\n        <div>\n            <a href='javascript:excludePokemon(${id})'>Exclude</a>&nbsp;&nbsp\n            <a href='javascript:notifyAboutPokemon(${id})'>Notify</a>&nbsp;&nbsp\n            <a href='javascript:removePokemonMarker(\"${encounterId}\")'>Remove</a>&nbsp;&nbsp\n            <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n        </div>\n        <div>\n            ${scoutLink}\n            <a href='javascript:void(0);' onclick='javascript:toggleOtherPokemon(\"${id}\");' title='Toggle display of other Pokemon'>Toggle Others</a>\n        </div>`\n    return contentstring\n}\n\nfunction gymLabel(teamName, teamId, gymPoints, latitude, longitude, lastScanned = null, lastModified = null, name = null, members = [], gymId) {\n    var memberStr = ''\n    for (var i = 0; i < members.length; i++) {\n        memberStr += `\n            <span class=\"gym-member\" title=\"${members[i].pokemon_name} | ${members[i].trainer_name} (Lvl ${members[i].trainer_level})\">\n                <i class=\"pokemon-sprite n${members[i].pokemon_id}\"></i>\n                <span class=\"cp team-${teamId}\">${members[i].pokemon_cp}</span>\n            </span>`\n    }\n\n    var lastScannedStr = getDateStr(lastScanned)\n    var lastModifiedStr = getDateStr(lastModified)\n    var directionsStr = ''\n    if (!Store.get('useGymSidebar')) {\n        directionsStr = `<div>\n                <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n            </div>`\n    }\n\n    var nameStr = (name ? `<div>${name}</div>` : '')\n\n    var gymColor = ['0, 0, 0, .4', '74, 138, 202, .6', '240, 68, 58, .6', '254, 217, 40, .6']\n    var str\n    if (teamId === 0) {\n        str = `\n            <div>\n                <center>\n                    <div>\n                        <b style='color:rgba(${gymColor[teamId]})'>${teamName}</b><br>\n                        <img height='70px' style='padding: 5px;' src='static/forts/${teamName}_large.png'>\n                    </div>\n                    ${nameStr}\n                    <div>\n                        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n                    </div>\n                    <div>\n                        Last Scanned: ${lastScannedStr}\n                    </div>\n                    <div>\n                        Last Modified: ${lastModifiedStr}\n                    </div>\n                    ${directionsStr}\n                </center>\n            </div>`\n    } else {\n        var gymLevel = getGymLevel(gymPoints)\n        str = `\n            <div>\n                <center>\n                    <div style='padding-bottom: 2px'>\n                        Gym owned by:\n                    </div>\n                    <div>\n                        <b style='color:rgba(${gymColor[teamId]})'>Team ${teamName}</b><br>\n                        <img height='70px' style='padding: 5px;' src='static/forts/${teamName}_large.png'>\n                    </div>\n                    <div>\n                        ${nameStr}\n                    </div>\n                    <div>\n                        Level: ${gymLevel} | Prestige: ${gymPoints}/${gymPrestige[gymLevel - 1] || 50000}\n                    </div>\n                    <div>\n                        ${memberStr}\n                    </div>\n                    <div>\n                        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n                    </div>\n                    <div>\n                        Last Scanned: ${lastScannedStr}\n                    </div>\n                    <div>\n                        Last Modified: ${lastModifiedStr}\n                    </div>\n                    ${directionsStr}\n                </center>\n            </div>`\n    }\n\n    return str\n}\n\nfunction getGymLevel(points) {\n    var level = 1\n    while (points >= gymPrestige[level - 1]) {\n        level++\n    }\n\n    return level\n}\n\nfunction pokestopLabel(expireTime, latitude, longitude) {\n    var str\n    if (expireTime) {\n        var expireDate = new Date(expireTime)\n\n        str = `\n            <div>\n                <b>Lured Pokstop</b>\n            </div>\n            <div>\n                Lure expires at ${pad(expireDate.getHours())}:${pad(expireDate.getMinutes())}:${pad(expireDate.getSeconds())}\n                <span class='label-countdown' disappears-at='${expireTime}'>(00m00s)</span>\n            </div>\n            <div>\n                Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n            </div>\n            <div>\n                <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n            </div>`\n    } else {\n        str = `\n            <div>\n                <b>Pokstop</b>\n            </div>\n            <div>\n                Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\n            </div>\n            <div>\n                <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\n            </div>`\n    }\n\n    return str\n}\n\nfunction formatSpawnTime(seconds) {\n    // the addition and modulo are required here because the db stores when a spawn disappears\n    // the subtraction to get the appearance time will knock seconds under 0 if the spawn happens in the previous hour\n    return ('0' + Math.floor(((seconds + 3600) % 3600) / 60)).substr(-2) + ':' + ('0' + seconds % 60).substr(-2)\n}\n\nfunction spawnpointLabel(item) {\n    var str = `\n        <div>\n            <b>Spawn Point</b>\n        </div>\n        <div>\n            Every hour from ${formatSpawnTime(item.time)} to ${formatSpawnTime(item.time + 900)}\n        </div>`\n\n    if (item.special) {\n        str += `\n            <div>\n                May appear as early as ${formatSpawnTime(item.time - 1800)}\n            </div>`\n    }\n    return str\n}\n\nfunction addRangeCircle(marker, map, type, teamId) {\n    var targetmap = null\n    var circleCenter = new google.maps.LatLng(marker.position.lat(), marker.position.lng())\n    var gymColors = ['#999999', '#0051CF', '#FF260E', '#FECC23'] // 'Uncontested', 'Mystic', 'Valor', 'Instinct']\n    var teamColor = gymColors[0]\n    if (teamId) teamColor = gymColors[teamId]\n\n    var range\n    var circleColor\n\n    // handle each type of marker and be explicit about the range circle attributes\n    switch (type) {\n        case 'pokemon':\n            circleColor = '#C233F2'\n            range = 40 // pokemon appear at 40m and then you can move away. still have to be 40m close to see it though, so ignore the further disappear distance\n            break\n        case 'pokestop':\n            circleColor = '#3EB0FF'\n            range = 40\n            break\n        case 'gym':\n            circleColor = teamColor\n            range = 40\n            break\n    }\n\n    if (map) targetmap = map\n\n    var rangeCircleOpts = {\n        map: targetmap,\n        radius: range, // meters\n        strokeWeight: 1,\n        strokeColor: circleColor,\n        strokeOpacity: 0.9,\n        center: circleCenter,\n        fillColor: circleColor,\n        fillOpacity: 0.3\n    }\n    var rangeCircle = new google.maps.Circle(rangeCircleOpts)\n    return rangeCircle\n}\n\nfunction isRangeActive(map) {\n    if (map.getZoom() < 16) return false\n    return Store.get('showRanges')\n}\n\nfunction getIv(atk, def, stm) {\n    if (atk !== null) {\n        return 100.0 * (atk + def + stm) / 45\n    }\n\n    return false\n}\n\nfunction lpad(str, len, padstr) {\n    return Array(Math.max(len - String(str).length + 1, 0)).join(padstr) + str\n}\n\nfunction repArray(text, find, replace) {\n    for (var i = 0; i < find.length; i++) {\n        text = text.replace(find[i], replace[i])\n    }\n\n    return text\n}\n\nfunction getTimeUntil(time) {\n    var now = +new Date()\n    var tdiff = time - now\n\n    var sec = Math.floor((tdiff / 1000) % 60)\n    var min = Math.floor((tdiff / 1000 / 60) % 60)\n    var hour = Math.floor((tdiff / (1000 * 60 * 60)) % 24)\n\n    return {\n        'total': tdiff,\n        'hour': hour,\n        'min': min,\n        'sec': sec,\n        'now': now,\n        'ttime': time\n    }\n}\n\nfunction getNotifyText(item) {\n    var iv = getIv(item['individual_attack'], item['individual_defense'], item['individual_stamina'])\n    var find = ['<prc>', '<pkm>', '<atk>', '<def>', '<sta>']\n    var replace = [((iv) ? iv.toFixed(1) : ''), item['pokemon_name'], item['individual_attack'],\n        item['individual_defense'], item['individual_stamina']]\n    var ntitle = repArray(((iv) ? notifyIvTitle : notifyNoIvTitle), find, replace)\n    var dist = (new Date(item['disappear_time'])).toLocaleString([], {\n        hour: '2-digit', minute: '2-digit',\n        second: '2-digit', hour12: false})\n    var until = getTimeUntil(item['disappear_time'])\n    var udist = (until.hour > 0) ? until.hour + ':' : ''\n    udist += lpad(until.min, 2, 0) + 'm' + lpad(until.sec, 2, 0) + 's'\n    find = ['<dist>', '<udist>']\n    replace = [dist, udist]\n    var ntext = repArray(notifyText, find, replace)\n\n    return {\n        'fav_title': ntitle,\n        'fav_text': ntext\n    }\n}\n\nfunction customizePokemonMarker(marker, item, skipNotification) {\n    marker.addListener('click', function () {\n        this.setAnimation(null)\n        this.animationDisabled = true\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'pokemon')\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: pokemonLabel(item),\n        disableAutoPan: true\n    })\n\n    if (notifiedPokemon.indexOf(item['pokemon_id']) > -1 || notifiedRarity.indexOf(item['pokemon_rarity']) > -1) {\n        if (!skipNotification) {\n            if (Store.get('playSound')) {\n                audio.play()\n            }\n            sendNotification(getNotifyText(item).fav_title, getNotifyText(item).fav_text, 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\n        }\n        if (marker.animationDisabled !== true) {\n            marker.setAnimation(google.maps.Animation.BOUNCE)\n        }\n    }\n\n    if (item['individual_attack'] != null) {\n        var perfection = getIv(item['individual_attack'], item['individual_defense'], item['individual_stamina'])\n        if (notifiedMinPerfection > 0 && perfection >= notifiedMinPerfection) {\n            if (!skipNotification) {\n                if (Store.get('playSound')) {\n                    audio.play()\n                }\n                sendNotification(getNotifyText(item).fav_title, getNotifyText(item).fav_text, 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\n            }\n            if (marker.animationDisabled !== true) {\n                marker.setAnimation(google.maps.Animation.BOUNCE)\n            }\n        }\n    }\n\n    addListeners(marker)\n}\n\nfunction setupGymMarker(item) {\n    var marker = new google.maps.Marker({\n        position: {\n            lat: item['latitude'],\n            lng: item['longitude']\n        },\n        map: map,\n        icon: {\n            url: 'static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[item['team_id']] + (item['team_id'] !== 0 ? '_' + getGymLevel(item['gym_points']) : '') + '.png',\n            scaledSize: new google.maps.Size(48, 48)\n        }\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'gym', item['team_id'])\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['last_modified'], item['name'], item['pokemon'], item['gym_id']),\n        disableAutoPan: true\n    })\n\n    if (Store.get('useGymSidebar')) {\n        marker.addListener('click', function () {\n            var gymSidebar = document.querySelector('#gym-details')\n            if (gymSidebar.getAttribute('data-id') === item['gym_id'] && gymSidebar.classList.contains('visible')) {\n                gymSidebar.classList.remove('visible')\n            } else {\n                gymSidebar.setAttribute('data-id', item['gym_id'])\n                showGymDetails(item['gym_id'])\n            }\n        })\n\n        google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n            marker.persist = null\n        })\n\n        if (!isMobileDevice() && !isTouchDevice()) {\n            marker.addListener('mouseover', function () {\n                marker.infoWindow.open(map, marker)\n                clearSelection()\n                updateLabelDiffTime()\n            })\n        }\n\n        marker.addListener('mouseout', function () {\n            if (!marker.persist) {\n                marker.infoWindow.close()\n            }\n        })\n    } else {\n        addListeners(marker)\n    }\n    return marker\n}\n\nfunction updateGymMarker(item, marker) {\n    marker.setIcon({\n        url: 'static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[item['team_id']] + (item['team_id'] !== 0 ? '_' + getGymLevel(item['gym_points']) : '') + '.png',\n        scaledSize: new google.maps.Size(48, 48)\n    })\n    marker.infoWindow.setContent(gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['last_modified'], item['name'], item['pokemon'], item['gym_id']))\n    return marker\n}\n\nfunction updateGymIcons() {\n    $.each(mapData.gyms, function (key, value) {\n        mapData.gyms[key]['marker'].setIcon({\n            url: 'static/forts/' + Store.get('gymMarkerStyle') + '/' + gymTypes[mapData.gyms[key]['team_id']] + (mapData.gyms[key]['team_id'] !== 0 ? '_' + getGymLevel(mapData.gyms[key]['gym_points']) : '') + '.png',\n            scaledSize: new google.maps.Size(48, 48)\n        })\n    })\n}\n\nfunction setupPokestopMarker(item) {\n    var imagename = item['lure_expiration'] ? 'PstopLured' : 'Pstop'\n    var marker = new google.maps.Marker({\n        position: {\n            lat: item['latitude'],\n            lng: item['longitude']\n        },\n        map: map,\n        zIndex: 2,\n        icon: 'static/forts/' + imagename + '.png'\n    })\n\n    if (!marker.rangeCircle && isRangeActive(map)) {\n        marker.rangeCircle = addRangeCircle(marker, map, 'pokestop')\n    }\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: pokestopLabel(item['lure_expiration'], item['latitude'], item['longitude']),\n        disableAutoPan: true\n    })\n\n    addListeners(marker)\n    return marker\n}\n\nfunction getColorByDate(value) {\n    // Changes the color from red to green over 15 mins\n    var diff = (Date.now() - value) / 1000 / 60 / 15\n\n    if (diff > 1) {\n        diff = 1\n    }\n\n    // value from 0 to 1 - Green to Red\n    var hue = ((1 - diff) * 120).toString(10)\n    return ['hsl(', hue, ',100%,50%)'].join('')\n}\n\nfunction setupScannedMarker(item) {\n    var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n\n    var marker = new google.maps.Circle({\n        map: map,\n        clickable: false,\n        center: circleCenter,\n        radius: 70, // metres\n        fillColor: getColorByDate(item['last_modified']),\n        fillOpacity: 0.1,\n        strokeWeight: 1,\n        strokeOpacity: 0.5\n    })\n\n    return marker\n}\n\nfunction getColorBySpawnTime(value) {\n    var now = new Date()\n    var seconds = now.getMinutes() * 60 + now.getSeconds()\n\n    // account for hour roll-over\n    if (seconds < 900 && value > 2700) {\n        seconds += 3600\n    } else if (seconds > 2700 && value < 900) {\n        value += 3600\n    }\n\n    var diff = (seconds - value)\n    var hue = 275 // light purple when spawn is neither about to spawn nor active\n    if (diff >= 0 && diff <= 900) { // green to red over 15 minutes of active spawn\n        hue = (1 - (diff / 60 / 15)) * 120\n    } else if (diff < 0 && diff > -300) { // light blue to dark blue over 5 minutes til spawn\n        hue = ((1 - (-diff / 60 / 5)) * 50) + 200\n    }\n\n    hue = Math.round(hue / 5) * 5\n\n    return hue\n}\n\nfunction changeSpawnIcon(color, zoom) {\n    var urlColor = ''\n    if (color === 275) {\n        urlColor = './static/icons/hsl-275-light.png'\n    } else {\n        urlColor = './static/icons/hsl-' + color + '.png'\n    }\n    var zoomScale = 1.6 // adjust this value to change the size of the spawnpoint icons\n    var minimumSize = 1\n    var newSize = Math.round(zoomScale * (zoom - 10)) // this scales the icon based on zoom\n    if (newSize < minimumSize) {\n        newSize = minimumSize\n    }\n\n    var newIcon = {\n        url: urlColor,\n        scaledSize: new google.maps.Size(newSize, newSize),\n        anchor: new google.maps.Point(newSize / 2, newSize / 2)\n    }\n\n    return newIcon\n}\n\nfunction spawnPointIndex(color) {\n    var newIndex = 1\n    var scale = 0\n    if (color >= 0 && color <= 120) { // high to low over 15 minutes of active spawn\n        scale = color / 120\n        newIndex = 100 + scale * 100\n    } else if (color >= 200 && color <= 250) { // low to high over 5 minutes til spawn\n        scale = (color - 200) / 50\n        newIndex = scale * 100\n    }\n\n    return newIndex\n}\n\nfunction setupSpawnpointMarker(item) {\n    var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\n    var hue = getColorBySpawnTime(item.time)\n    var zoom = map.getZoom()\n\n    var marker = new google.maps.Marker({\n        map: map,\n        position: circleCenter,\n        icon: changeSpawnIcon(hue, zoom),\n        zIndex: spawnPointIndex(hue)\n    })\n\n    marker.infoWindow = new google.maps.InfoWindow({\n        content: spawnpointLabel(item),\n        disableAutoPan: true,\n        position: circleCenter\n    })\n\n    addListeners(marker)\n\n    return marker\n}\n\nfunction clearSelection() {\n    if (document.selection) {\n        document.selection.empty()\n    } else if (window.getSelection) {\n        window.getSelection().removeAllRanges()\n    }\n}\n\nfunction addListeners(marker) {\n    marker.addListener('click', function () {\n        if (!marker.infoWindowIsOpen) {\n            marker.infoWindow.open(map, marker)\n            clearSelection()\n            updateLabelDiffTime()\n            marker.persist = true\n            marker.infoWindowIsOpen = true\n        } else {\n            marker.persist = null\n            marker.infoWindow.close()\n            marker.infoWindowIsOpen = false\n        }\n    })\n\n    google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\n        marker.persist = null\n    })\n\n    if (!isMobileDevice() && !isTouchDevice()) {\n        marker.addListener('mouseover', function () {\n            marker.infoWindow.open(map, marker)\n            clearSelection()\n            updateLabelDiffTime()\n        })\n    }\n\n    marker.addListener('mouseout', function () {\n        if (!marker.persist) {\n            marker.infoWindow.close()\n        }\n    })\n\n    return marker\n}\n\nfunction isTemporaryHidden(pokemonId) {\n    return onlyPokemon != 0 && pokemonId != onlyPokemon\n}\n\nfunction clearStaleMarkers() {\n    $.each(mapData.pokemons, function (key, value) {\n        if (mapData.pokemons[key]['disappear_time'] < new Date().getTime() ||\n            excludedPokemon.indexOf(mapData.pokemons[key]['pokemon_id']) >= 0 ||\n            isTemporaryHidden(mapData.pokemons[key]['pokemon_id'])) {\n            if (mapData.pokemons[key].marker.rangeCircle) {\n                mapData.pokemons[key].marker.rangeCircle.setMap(null)\n                delete mapData.pokemons[key].marker.rangeCircle\n            }\n            mapData.pokemons[key].marker.setMap(null)\n            delete mapData.pokemons[key]\n        }\n    })\n\n    $.each(mapData.lurePokemons, function (key, value) {\n        if (mapData.lurePokemons[key]['lure_expiration'] < new Date().getTime() ||\n            excludedPokemon.indexOf(mapData.lurePokemons[key]['pokemon_id']) >= 0) {\n            mapData.lurePokemons[key].marker.setMap(null)\n            delete mapData.lurePokemons[key]\n        }\n    })\n\n    $.each(mapData.scanned, function (key, value) {\n        // If older than 15mins remove\n        if (mapData.scanned[key]['last_modified'] < (new Date().getTime() - 15 * 60 * 1000)) {\n            mapData.scanned[key].marker.setMap(null)\n            delete mapData.scanned[key]\n        }\n    })\n}\n\nfunction showInBoundsMarkers(markers, type) {\n    $.each(markers, function (key, value) {\n        var marker = markers[key].marker\n        var show = false\n        if (!markers[key].hidden) {\n            if (typeof marker.getBounds === 'function') {\n                if (map.getBounds().intersects(marker.getBounds())) {\n                    show = true\n                }\n            } else if (typeof marker.getPosition === 'function') {\n                if (map.getBounds().contains(marker.getPosition())) {\n                    show = true\n                }\n            }\n        }\n        // marker has an associated range\n        if (show && rangeMarkers.indexOf(type) !== -1) {\n            // no range circle yet...let's create one\n            if (!marker.rangeCircle) {\n                // but only if range is active\n                if (isRangeActive(map)) {\n                    if (type === 'gym') marker.rangeCircle = addRangeCircle(marker, map, type, markers[key].team_id)\n                    else marker.rangeCircle = addRangeCircle(marker, map, type)\n                }\n            } else { // there's already a range circle\n                if (isRangeActive(map)) {\n                    marker.rangeCircle.setMap(map)\n                } else {\n                    marker.rangeCircle.setMap(null)\n                }\n            }\n        }\n\n        if (show && !marker.getMap()) {\n            marker.setMap(map)\n            // Not all markers can be animated (ex: scan locations)\n            if (marker.setAnimation && marker.oldAnimation) {\n                marker.setAnimation(marker.oldAnimation)\n            }\n        } else if (!show && marker.getMap()) {\n            // Not all markers can be animated (ex: scan locations)\n            if (marker.getAnimation) {\n                marker.oldAnimation = marker.getAnimation()\n            }\n            if (marker.rangeCircle) marker.rangeCircle.setMap(null)\n            marker.setMap(null)\n        }\n    })\n}\n\nfunction loadRawData() {\n    var loadPokemon = Store.get('showPokemon')\n    var loadGyms = Store.get('showGyms')\n    var loadPokestops = Store.get('showPokestops')\n    var loadScanned = Store.get('showScanned')\n    var loadSpawnpoints = Store.get('showSpawnpoints')\n    var loadLuredOnly = Boolean(Store.get('showLuredPokestopsOnly'))\n\n    var bounds = map.getBounds()\n    var swPoint = bounds.getSouthWest()\n    var nePoint = bounds.getNorthEast()\n    var swLat = swPoint.lat()\n    var swLng = swPoint.lng()\n    var neLat = nePoint.lat()\n    var neLng = nePoint.lng()\n\n    return $.ajax({\n        url: 'raw_data',\n        type: 'GET',\n        data: {\n            'timestamp': timestamp,\n            'pokemon': loadPokemon,\n            'lastpokemon': lastpokemon,\n            'pokestops': loadPokestops,\n            'lastpokestops': lastpokestops,\n            'luredonly': loadLuredOnly,\n            'gyms': loadGyms,\n            'lastgyms': lastgyms,\n            'scanned': loadScanned,\n            'lastslocs': lastslocs,\n            'spawnpoints': loadSpawnpoints,\n            'lastspawns': lastspawns,\n            'swLat': swLat,\n            'swLng': swLng,\n            'neLat': neLat,\n            'neLng': neLng,\n            'oSwLat': oSwLat,\n            'oSwLng': oSwLng,\n            'oNeLat': oNeLat,\n            'oNeLng': oNeLng,\n            'reids': String(reincludedPokemon),\n            'eids': String(excludedPokemon)\n        },\n        dataType: 'json',\n        cache: false,\n        beforeSend: function () {\n            if (rawDataIsLoading) {\n                return false\n            } else {\n                rawDataIsLoading = true\n            }\n        },\n        error: function () {\n            // Display error toast\n            toastr['error']('Please check connectivity or reduce marker settings.', 'Error getting data')\n            toastr.options = {\n                'closeButton': true,\n                'debug': false,\n                'newestOnTop': true,\n                'progressBar': false,\n                'positionClass': 'toast-top-right',\n                'preventDuplicates': true,\n                'onclick': null,\n                'showDuration': '300',\n                'hideDuration': '1000',\n                'timeOut': '25000',\n                'extendedTimeOut': '1000',\n                'showEasing': 'swing',\n                'hideEasing': 'linear',\n                'showMethod': 'fadeIn',\n                'hideMethod': 'fadeOut'\n            }\n        },\n        complete: function () {\n            rawDataIsLoading = false\n        }\n    })\n}\n\nfunction processPokemons(i, item) {\n    if (!Store.get('showPokemon')) {\n        return false // in case the checkbox was unchecked in the meantime.\n    }\n\n    if (!(item['encounter_id'] in mapData.pokemons) &&\n        excludedPokemon.indexOf(item['pokemon_id']) < 0 && item['disappear_time'] > Date.now() &&\n        !isTemporaryHidden(item['pokemon_id'])) {\n        // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        if (!item.hidden) {\n            item.marker = setupPokemonMarker(item, map)\n            customizePokemonMarker(item.marker, item)\n            mapData.pokemons[item['encounter_id']] = item\n        }\n    }\n}\n\nfunction processPokestops(i, item) {\n    if (!Store.get('showPokestops')) {\n        return false\n    }\n\n    if (Store.get('showLuredPokestopsOnly') && !item['lure_expiration']) {\n        return true\n    }\n\n    if (!mapData.pokestops[item['pokestop_id']]) { // new pokestop, add marker to map and item to dict\n        if (item.marker && item.marker.rangeCircle) {\n            item.marker.rangeCircle.setMap(null)\n        }\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupPokestopMarker(item)\n        mapData.pokestops[item['pokestop_id']] = item\n    } else { // change existing pokestop marker to unlured/lured\n        var item2 = mapData.pokestops[item['pokestop_id']]\n        if (!!item['lure_expiration'] !== !!item2['lure_expiration']) {\n            if (item2.marker && item2.marker.rangeCircle) {\n                item2.marker.rangeCircle.setMap(null)\n            }\n            item2.marker.setMap(null)\n            item.marker = setupPokestopMarker(item)\n            mapData.pokestops[item['pokestop_id']] = item\n        }\n    }\n}\n\nfunction updatePokestops() {\n    if (!Store.get('showPokestops')) {\n        return false\n    }\n\n    var removeStops = []\n    var currentTime = new Date().getTime()\n\n    // change lured pokestop marker to unlured when expired\n    $.each(mapData.pokestops, function (key, value) {\n        if (value['lure_expiration'] && value['lure_expiration'] < currentTime) {\n            value['lure_expiration'] = null\n            if (value.marker && value.marker.rangeCircle) {\n                value.marker.rangeCircle.setMap(null)\n            }\n            value.marker.setMap(null)\n            value.marker = setupPokestopMarker(value)\n        }\n    })\n\n    // remove unlured stops if show lured only is selected\n    if (Store.get('showLuredPokestopsOnly')) {\n        $.each(mapData.pokestops, function (key, value) {\n            if (!value['lure_expiration']) {\n                removeStops.push(key)\n            }\n        })\n        $.each(removeStops, function (key, value) {\n            if (mapData.pokestops[value] && mapData.pokestops[value].marker) {\n                if (mapData.pokestops[value].marker.rangeCircle) {\n                    mapData.pokestops[value].marker.rangeCircle.setMap(null)\n                }\n                mapData.pokestops[value].marker.setMap(null)\n                delete mapData.pokestops[value]\n            }\n        })\n    }\n}\n\nfunction processGyms(i, item) {\n    if (!Store.get('showGyms')) {\n        return false // in case the checkbox was unchecked in the meantime.\n    }\n\n    var gymLevel = getGymLevel(item.gym_points)\n    var removeGymFromMap = function (gymid) {\n        if (mapData.gyms[gymid] && mapData.gyms[gymid].marker) {\n            if (mapData.gyms[gymid].marker.rangeCircle) {\n                mapData.gyms[gymid].marker.rangeCircle.setMap(null)\n            }\n            mapData.gyms[gymid].marker.setMap(null)\n            delete mapData.gyms[gymid]\n        }\n    }\n\n    var gymHasOpenSpot = function (gymLevel, pokemonInGym) {\n        return gymLevel > item.pokemon.length && item.pokemon.length !== 0\n    }\n\n    if (Store.get('showOpenGymsOnly') === 1) {\n        if (!gymHasOpenSpot(gymLevel, item.pokemon.length)) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (Store.get('showOpenGymsOnly') > 1) {\n        var closePrestige = 0\n        switch (Store.get('showOpenGymsOnly')) {\n            case 2:\n                closePrestige = 1000\n                break\n            case 3:\n                closePrestige = 2500\n                break\n            case 4:\n                closePrestige = 5000\n                break\n        }\n\n        if (!gymHasOpenSpot(gymLevel, item.pokemon.length) && (gymPrestige[gymLevel - 1] > closePrestige + item.gym_points || gymLevel === 10)) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (Store.get('showTeamGymsOnly') && Store.get('showTeamGymsOnly') !== item.team_id) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (Store.get('showLastUpdatedGymsOnly')) {\n        var now = new Date()\n        if ((Store.get('showLastUpdatedGymsOnly') * 3600 * 1000) + item.last_scanned < now.getTime()) {\n            removeGymFromMap(item['gym_id'])\n            return true\n        }\n    }\n\n    if (gymLevel < Store.get('minGymLevel')) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (gymLevel > Store.get('maxGymLevel')) {\n        removeGymFromMap(item['gym_id'])\n        return true\n    }\n\n    if (item['gym_id'] in mapData.gyms) {\n        item.marker = updateGymMarker(item, mapData.gyms[item['gym_id']].marker)\n    } else { // add marker to map and item to dict\n        item.marker = setupGymMarker(item)\n    }\n    mapData.gyms[item['gym_id']] = item\n}\n\nfunction processScanned(i, item) {\n    if (!Store.get('showScanned')) {\n        return false\n    }\n\n    var scanId = item['latitude'] + '|' + item['longitude']\n\n    if (!(scanId in mapData.scanned)) { // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupScannedMarker(item)\n        mapData.scanned[scanId] = item\n    } else {\n        mapData.scanned[scanId].last_modified = item['last_modified']\n    }\n}\n\nfunction updateScanned() {\n    if (!Store.get('showScanned')) {\n        return false\n    }\n\n    $.each(mapData.scanned, function (key, value) {\n        if (map.getBounds().intersects(value.marker.getBounds())) {\n            value.marker.setOptions({\n                fillColor: getColorByDate(value['last_modified'])\n            })\n        }\n    })\n}\n\nfunction processSpawnpoints(i, item) {\n    if (!Store.get('showSpawnpoints')) {\n        return false\n    }\n\n    var id = item['spawnpoint_id']\n\n    if (!(id in mapData.spawnpoints)) { // add marker to map and item to dict\n        if (item.marker) {\n            item.marker.setMap(null)\n        }\n        item.marker = setupSpawnpointMarker(item)\n        mapData.spawnpoints[id] = item\n    }\n}\n\nfunction updateSpawnPoints() {\n    if (!Store.get('showSpawnpoints')) {\n        return false\n    }\n\n    var zoom = map.getZoom()\n\n    $.each(mapData.spawnpoints, function (key, value) {\n        if (map.getBounds().contains(value.marker.getPosition())) {\n            var hue = getColorBySpawnTime(value['time'])\n            value.marker.setIcon(changeSpawnIcon(hue, zoom))\n            value.marker.setZIndex(spawnPointIndex(hue))\n        }\n    })\n}\n\nfunction updateMap() {\n    loadRawData().done(function (result) {\n        $.each(result.pokemons, processPokemons)\n        $.each(result.pokestops, processPokestops)\n        $.each(result.gyms, processGyms)\n        $.each(result.scanned, processScanned)\n        $.each(result.spawnpoints, processSpawnpoints)\n        showInBoundsMarkers(mapData.pokemons, 'pokemon')\n        showInBoundsMarkers(mapData.lurePokemons, 'pokemon')\n        showInBoundsMarkers(mapData.gyms, 'gym')\n        showInBoundsMarkers(mapData.pokestops, 'pokestop')\n        showInBoundsMarkers(mapData.scanned, 'scanned')\n        showInBoundsMarkers(mapData.spawnpoints, 'inbound')\n        //      drawScanPath(result.scanned);\n        clearStaleMarkers()\n\n        updateScanned()\n        updateSpawnPoints()\n        updatePokestops()\n\n        if ($('#stats').hasClass('visible')) {\n            countMarkers(map)\n        }\n\n        oSwLat = result.oSwLat\n        oSwLng = result.oSwLng\n        oNeLat = result.oNeLat\n        oNeLng = result.oNeLng\n\n        lastgyms = result.lastgyms\n        lastpokestops = result.lastpokestops\n        lastpokemon = result.lastpokemon\n        lastslocs = result.lastslocs\n        lastspawns = result.lastspawns\n\n        reids = result.reids\n        if (reids instanceof Array) {\n            ad = reids.filter(function (e) {\n                return this.indexOf(e) < 0\n            }, reincludedPokemon)\n        }\n        timestamp = result.timestamp\n        lastUpdateTime = Date.now()\n    })\n}\n\nfunction drawScanPath(points) { // eslint-disable-line no-unused-vars\n    var scanPathPoints = []\n    $.each(points, function (idx, point) {\n        scanPathPoints.push({\n            lat: point['latitude'],\n            lng: point['longitude']\n        })\n    })\n    if (scanPath) {\n        scanPath.setMap(null)\n    }\n    scanPath = new google.maps.Polyline({\n        path: scanPathPoints,\n        geodesic: true,\n        strokeColor: '#FF0000',\n        strokeOpacity: 1.0,\n        strokeWeight: 2,\n        map: map\n    })\n}\n\nfunction redrawPokemon(pokemonList) {\n    var skipNotification = true\n    $.each(pokemonList, function (key, value) {\n        var item = pokemonList[key]\n        if (!item.hidden) {\n            if (item.marker.rangeCircle) item.marker.rangeCircle.setMap(null)\n            var newMarker = setupPokemonMarker(item, map, this.marker.animationDisabled)\n            customizePokemonMarker(newMarker, item, skipNotification)\n            item.marker.setMap(null)\n            pokemonList[key].marker = newMarker\n        }\n    })\n}\n\nvar updateLabelDiffTime = function () {\n    $('.label-countdown').each(function (index, element) {\n        var disappearsAt = getTimeUntil(parseInt(element.getAttribute('disappears-at')))\n\n        var hours = disappearsAt.hour\n        var minutes = disappearsAt.min\n        var seconds = disappearsAt.sec\n        var timestring = ''\n\n        if (disappearsAt.ttime < disappearsAt.now) {\n            timestring = '(expired)'\n        } else {\n            timestring = '('\n            if (hours > 0) {\n                timestring = hours + 'h'\n            }\n\n            timestring += lpad(minutes, 2, 0) + 'm'\n            timestring += lpad(seconds, 2, 0) + 's'\n            timestring += ')'\n        }\n\n        $(element).text(timestring)\n    })\n}\n\nfunction getPointDistance(pointA, pointB) {\n    return google.maps.geometry.spherical.computeDistanceBetween(pointA, pointB)\n}\n\nfunction sendNotification(title, text, icon, lat, lng) {\n    if (!('Notification' in window)) {\n        return false // Notifications are not present in browser\n    }\n\n    if (Notification.permission !== 'granted') {\n        Notification.requestPermission()\n    } else {\n        var notification = new Notification(title, {\n            icon: icon,\n            body: text,\n            sound: 'sounds/ding.mp3'\n        })\n\n        notification.onclick = function () {\n            window.focus()\n            notification.close()\n\n            centerMap(lat, lng, 20)\n        }\n    }\n}\n\nfunction createMyLocationButton() {\n    var locationContainer = document.createElement('div')\n\n    var locationButton = document.createElement('button')\n    locationButton.style.backgroundColor = '#fff'\n    locationButton.style.border = 'none'\n    locationButton.style.outline = 'none'\n    locationButton.style.width = '28px'\n    locationButton.style.height = '28px'\n    locationButton.style.borderRadius = '2px'\n    locationButton.style.boxShadow = '0 1px 4px rgba(0,0,0,0.3)'\n    locationButton.style.cursor = 'pointer'\n    locationButton.style.marginRight = '10px'\n    locationButton.style.padding = '0px'\n    locationButton.title = 'My Location'\n    locationContainer.appendChild(locationButton)\n\n    var locationIcon = document.createElement('div')\n    locationIcon.style.margin = '5px'\n    locationIcon.style.width = '18px'\n    locationIcon.style.height = '18px'\n    locationIcon.style.backgroundImage = 'url(static/mylocation-sprite-1x.png)'\n    locationIcon.style.backgroundSize = '180px 18px'\n    locationIcon.style.backgroundPosition = '0px 0px'\n    locationIcon.style.backgroundRepeat = 'no-repeat'\n    locationIcon.id = 'current-location'\n    locationButton.appendChild(locationIcon)\n\n    locationButton.addEventListener('click', function () {\n        centerMapOnLocation()\n    })\n\n    locationContainer.index = 1\n    map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(locationContainer)\n\n    google.maps.event.addListener(map, 'dragend', function () {\n        var currentLocation = document.getElementById('current-location')\n        currentLocation.style.backgroundPosition = '0px 0px'\n    })\n}\n\nfunction centerMapOnLocation() {\n    var currentLocation = document.getElementById('current-location')\n    var imgX = '0'\n    var animationInterval = setInterval(function () {\n        if (imgX === '-18') {\n            imgX = '0'\n        } else {\n            imgX = '-18'\n        }\n        currentLocation.style.backgroundPosition = imgX + 'px 0'\n    }, 500)\n    if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)\n            locationMarker.setPosition(latlng)\n            map.setCenter(latlng)\n            Store.set('followMyLocationPosition', {\n                lat: position.coords.latitude,\n                lng: position.coords.longitude\n            })\n            clearInterval(animationInterval)\n            currentLocation.style.backgroundPosition = '-144px 0px'\n        })\n    } else {\n        clearInterval(animationInterval)\n        currentLocation.style.backgroundPosition = '0px 0px'\n    }\n}\n\nfunction changeLocation(lat, lng) {\n    var loc = new google.maps.LatLng(lat, lng)\n    changeSearchLocation(lat, lng).done(function () {\n        map.setCenter(loc)\n        searchMarker.setPosition(loc)\n    })\n}\n\nfunction changeSearchLocation(lat, lng) {\n    return $.post('next_loc?lat=' + lat + '&lon=' + lng, {})\n}\n\nfunction centerMap(lat, lng, zoom) {\n    var loc = new google.maps.LatLng(lat, lng)\n\n    map.setCenter(loc)\n\n    if (zoom) {\n        storeZoom = false\n        map.setZoom(zoom)\n    }\n}\n\nfunction i8ln(word) {\n    if ($.isEmptyObject(i8lnDictionary) && language !== 'en' && languageLookups < languageLookupThreshold) {\n        $.ajax({\n            url: 'static/dist/locales/' + language + '.min.json',\n            dataType: 'json',\n            async: false,\n            success: function (data) {\n                i8lnDictionary = data\n            },\n            error: function (jqXHR, status, error) {\n                console.log('Error loading i8ln dictionary: ' + error)\n                languageLookups++\n            }\n        })\n    }\n    if (word in i8lnDictionary) {\n        return i8lnDictionary[word]\n    } else {\n        // Word doesn't exist in dictionary return it as is\n        return word\n    }\n}\n\nfunction updateGeoLocation() {\n    if (navigator.geolocation && (Store.get('geoLocate') || Store.get('followMyLocation'))) {\n        navigator.geolocation.getCurrentPosition(function (position) {\n            var lat = position.coords.latitude\n            var lng = position.coords.longitude\n            var center = new google.maps.LatLng(lat, lng)\n\n            if (Store.get('geoLocate')) {\n                // the search function makes any small movements cause a loop. Need to increase resolution\n                if ((typeof searchMarker !== 'undefined') && (getPointDistance(searchMarker.getPosition(), center) > 40)) {\n                    $.post('next_loc?lat=' + lat + '&lon=' + lng).done(function () {\n                        map.panTo(center)\n                        searchMarker.setPosition(center)\n                    })\n                }\n            }\n            if (Store.get('followMyLocation')) {\n                if ((typeof locationMarker !== 'undefined') && (getPointDistance(locationMarker.getPosition(), center) >= 5)) {\n                    map.panTo(center)\n                    locationMarker.setPosition(center)\n                    Store.set('followMyLocationPosition', {\n                        lat: lat,\n                        lng: lng\n                    })\n                }\n            }\n        })\n    }\n}\n\nfunction createUpdateWorker() {\n    try {\n        if (isMobileDevice() && (window.Worker)) {\n            var updateBlob = new Blob([`onmessage = function(e) {\n                var data = e.data\n                if (data.name === 'backgroundUpdate') {\n                    self.setInterval(function () {self.postMessage({name: 'backgroundUpdate'})}, 5000)\n                }\n            }`])\n\n            var updateBlobURL = window.URL.createObjectURL(updateBlob)\n\n            updateWorker = new Worker(updateBlobURL)\n\n            updateWorker.onmessage = function (e) {\n                var data = e.data\n                if (document.hidden && data.name === 'backgroundUpdate' && Date.now() - lastUpdateTime > 2500) {\n                    updateMap()\n                    updateGeoLocation()\n                }\n            }\n\n            updateWorker.postMessage({\n                name: 'backgroundUpdate'\n            })\n        }\n    } catch (ex) {\n        console.log('Webworker error: ' + ex.message)\n    }\n}\n\nfunction showGymDetails(id) { // eslint-disable-line no-unused-vars\n    var sidebar = document.querySelector('#gym-details')\n    var sidebarClose\n\n    sidebar.classList.add('visible')\n\n    var data = $.ajax({\n        url: 'gym_data',\n        type: 'GET',\n        data: {\n            'id': id\n        },\n        dataType: 'json',\n        cache: false\n    })\n\n    data.done(function (result) {\n        var gymLevel = getGymLevel(result.gym_points)\n        var nextLvlPrestige = gymPrestige[gymLevel - 1] || 50000\n        var prestigePercentage = (result.gym_points / nextLvlPrestige) * 100\n        var lastScannedDateStr = getDateStr(result.last_scanned)\n        var lastModifiedDateStr = getDateStr(result.last_modified)\n        var freeSlots = result.pokemon.length ? gymLevel - result.pokemon.length : 0\n        var freeSlotsStr = freeSlots ? ` - ${freeSlots} Free Slots` : ''\n        var gymLevelStr = ''\n\n        if (result.team_id === 0) {\n            gymLevelStr = `\n                <center>\n                    <b>Uncontested - 1 Free Slot</b>\n                </center>`\n        } else {\n            gymLevelStr = `<div>\n                <b>Level ${gymLevel}${freeSlotsStr}</b>\n            </div>`\n        }\n        var pokemonHtml = ''\n        var headerHtml = `\n            <center>\n                <div>\n                    <b>${result.name || ''}</b>\n                </div>\n                <img height=\"100px\" style=\"padding: 5px;\" src=\"static/forts/${gymTypes[result.team_id]}_large.png\">\n                <div class=\"prestige-bar team-${result.team_id}\">\n                    <div class=\"prestige team-${result.team_id}\" style=\"width: ${prestigePercentage}%\">\n                    </div>\n                </div>\n                <div>\n                    ${result.gym_points}/${nextLvlPrestige}\n                </div>\n                ${gymLevelStr}\n                <div style=\"font-size: .7em;\">\n                    Last Scanned: ${lastScannedDateStr}\n                </div>\n                <div style=\"font-size: .7em;\">\n                    Last Modified: ${lastModifiedDateStr}\n                </div>\n                <div>\n                    <a href='javascript:void(0);' onclick='javascript:openMapDirections(${result.latitude},${result.longitude});' title='View in Maps'>Get directions</a>\n                </div>\n            </center>\n        `\n\n        if (result.pokemon.length) {\n            $.each(result.pokemon, function (i, pokemon) {\n                var perfectPercent = getIv(pokemon.iv_attack, pokemon.iv_defense, pokemon.iv_stamina)\n                var moveEnergy = Math.round(100 / pokemon.move_2_energy)\n\n                pokemonHtml += `\n                    <tr onclick=toggleGymPokemonDetails(this)>\n                        <td width=\"30px\">\n                            <i class=\"pokemon-sprite n${pokemon.pokemon_id}\"></i>\n                        </td>\n                        <td>\n                            <div style=\"line-height:1em;\">${pokemon.pokemon_name}</div>\n                            <div class=\"cp\">CP ${pokemon.pokemon_cp}</div>\n                        </td>\n                        <td width=\"190\" align=\"center\">\n                            <div class=\"trainer-level\">${pokemon.trainer_level}</div>\n                            <div style=\"line-height: 1em;\">${pokemon.trainer_name}</div>\n                        </td>\n                        <td width=\"10\">\n                            <!--<a href=\"#\" onclick=\"toggleGymPokemonDetails(this)\">-->\n                                <i class=\"fa fa-angle-double-down\"></i>\n                            <!--</a>-->\n                        </td>\n                    </tr>\n                    <tr class=\"details\">\n                        <td colspan=\"2\">\n                            <div class=\"ivs\">\n                                <div class=\"iv\">\n                                    <div class=\"type\">ATK</div>\n                                    <div class=\"value\">\n                                        ${pokemon.iv_attack}\n                                    </div>\n                                </div>\n                                <div class=\"iv\">\n                                    <div class=\"type\">DEF</div>\n                                    <div class=\"value\">\n                                        ${pokemon.iv_defense}\n                                    </div>\n                                </div>\n                                <div class=\"iv\">\n                                    <div class=\"type\">STA</div>\n                                    <div class=\"value\">\n                                        ${pokemon.iv_stamina}\n                                    </div>\n                                </div>\n                                <div class=\"iv\" style=\"width: 36px;\"\">\n                                    <div class=\"type\">PERFECT</div>\n                                    <div class=\"value\">\n                                        ${perfectPercent.toFixed(0)}<span style=\"font-size: .6em;\">%</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </td>\n                        <td colspan=\"2\">\n                            <div class=\"moves\">\n                                <div class=\"move\">\n                                    <div class=\"name\">\n                                        ${pokemon.move_1_name}\n                                        <div class=\"type ${pokemon.move_1_type['type_en'].toLowerCase()}\">${pokemon.move_1_type['type']}</div>\n                                    </div>\n                                    <div class=\"damage\">\n                                        ${pokemon.move_1_damage}\n                                    </div>\n                                </div>\n                                <br>\n                                <div class=\"move\">\n                                    <div class=\"name\">\n                                        ${pokemon.move_2_name}\n                                        <div class=\"type ${pokemon.move_2_type['type_en'].toLowerCase()}\">${pokemon.move_2_type['type']}</div>\n                                        <div>\n                                            <i class=\"move-bar-sprite move-bar-sprite-${moveEnergy}\"></i>\n                                        </div>\n                                    </div>\n                                    <div class=\"damage\">\n                                        ${pokemon.move_2_damage}\n                                    </div>\n                                </div>\n                            </div>\n                        </td>\n                    </tr>\n                    `\n            })\n\n            pokemonHtml = `<table><tbody>${pokemonHtml}</tbody></table>`\n        } else if (result.team_id === 0) {\n            pokemonHtml = ''\n        } else {\n            pokemonHtml = `\n                <center>\n                    Gym Leader:<br>\n                    <i class=\"pokemon-large-sprite n${result.guard_pokemon_id}\"></i><br>\n                    <b>${result.guard_pokemon_name}</b>\n\n                    <p style=\"font-size: .75em; margin: 5px;\">\n                        No additional gym information is available for this gym. Make sure you are collecting <a href=\"https://rocketmap.readthedocs.io/en/develop/extras/gyminfo.html\">detailed gym info.</a>\n                        If you have detailed gym info collection running, this gym's Pokemon information may be out of date.\n                    </p>\n                </center>\n            `\n        }\n\n        sidebar.innerHTML = `${headerHtml}${pokemonHtml}`\n\n        sidebarClose = document.createElement('a')\n        sidebarClose.href = '#'\n        sidebarClose.className = 'close'\n        sidebarClose.tabIndex = 0\n        sidebar.appendChild(sidebarClose)\n\n        sidebarClose.addEventListener('click', function (event) {\n            event.preventDefault()\n            event.stopPropagation()\n            sidebar.classList.remove('visible')\n        })\n    })\n}\n\nfunction toggleGymPokemonDetails(e) { // eslint-disable-line no-unused-vars\n    e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-up')\n    e.lastElementChild.firstElementChild.classList.toggle('fa-angle-double-down')\n    e.nextElementSibling.classList.toggle('visible')\n}\n\n//\n// Page Ready Exection\n//\n\n$(function () {\n    if (!Notification) {\n        console.log('could not load notifications')\n        return\n    }\n\n    if (Notification.permission !== 'granted') {\n        Notification.requestPermission()\n    }\n})\n\n$(function () {\n    // populate Navbar Style menu\n    $selectStyle = $('#map-style')\n\n    // Load Stylenames, translate entries, and populate lists\n    $.getJSON('static/dist/data/mapstyle.min.json').done(function (data) {\n        var styleList = []\n\n        $.each(data, function (key, value) {\n            styleList.push({\n                id: key,\n                text: i8ln(value)\n            })\n        })\n\n        // setup the stylelist\n        $selectStyle.select2({\n            placeholder: 'Select Style',\n            data: styleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        // setup the list change behavior\n        $selectStyle.on('change', function (e) {\n            selectedStyle = $selectStyle.val()\n            map.setMapTypeId(selectedStyle)\n            Store.set('map_style', selectedStyle)\n        })\n\n        // recall saved mapstyle\n        $selectStyle.val(Store.get('map_style')).trigger('change')\n\t\t})\n\t\n        $selectIconResolution = $('#pokemon-icons')\n \n        $selectIconResolution.on('change', function () {\n            Store.set('pokemonIcons', this.value)\n            redrawPokemon(mapData.pokemons)\n            redrawPokemon(mapData.lurePokemons)\n        })\n\t\t\n    $selectIconSize = $('#pokemon-icon-size')\n\n\n    $selectIconSize.select2({\n        placeholder: 'Select Icon Size',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectIconSize.on('change', function () {\n        Store.set('iconSizeModifier', this.value)\n        redrawPokemon(mapData.pokemons)\n        redrawPokemon(mapData.lurePokemons)\n    })\n\n    $selectOpenGymsOnly = $('#open-gyms-only-switch')\n\n    $selectOpenGymsOnly.select2({\n        placeholder: 'Only Show Open Gyms',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectOpenGymsOnly.on('change', function () {\n        Store.set('showOpenGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectTeamGymsOnly = $('#team-gyms-only-switch')\n\n    $selectTeamGymsOnly.select2({\n        placeholder: 'Only Show Gyms For Team',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectTeamGymsOnly.on('change', function () {\n        Store.set('showTeamGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectLastUpdateGymsOnly = $('#last-update-gyms-switch')\n\n    $selectLastUpdateGymsOnly.select2({\n        placeholder: 'Only Show Gyms Last Updated',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectLastUpdateGymsOnly.on('change', function () {\n        Store.set('showLastUpdatedGymsOnly', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectMinGymLevel = $('#min-level-gyms-filter-switch')\n\n    $selectMinGymLevel.select2({\n        placeholder: 'Minimum Gym Level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectMinGymLevel.on('change', function () {\n        Store.set('minGymLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectMaxGymLevel = $('#max-level-gyms-filter-switch')\n\n    $selectMaxGymLevel.select2({\n        placeholder: 'Maximum Gym Level',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectMaxGymLevel.on('change', function () {\n        Store.set('maxGymLevel', this.value)\n        lastgyms = false\n        updateMap()\n    })\n\n    $selectLuredPokestopsOnly = $('#lured-pokestops-only-switch')\n\n    $selectLuredPokestopsOnly.select2({\n        placeholder: 'Only Show Lured Pokestops',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectLuredPokestopsOnly.on('change', function () {\n        Store.set('showLuredPokestopsOnly', this.value)\n        lastpokestops = false\n        updateMap()\n    })\n    $switchGymSidebar = $('#gym-sidebar-switch')\n\n    $switchGymSidebar.on('change', function () {\n        Store.set('useGymSidebar', this.checked)\n        lastgyms = false\n        $.each(['gyms'], function (d, dType) {\n            $.each(mapData[dType], function (key, value) {\n                // for any marker you're turning off, you'll want to wipe off the range\n                if (mapData[dType][key].marker.rangeCircle) {\n                    mapData[dType][key].marker.rangeCircle.setMap(null)\n                    delete mapData[dType][key].marker.rangeCircle\n                }\n                mapData[dType][key].marker.setMap(null)\n            })\n            mapData[dType] = {}\n        })\n        updateMap()\n    })\n\n    $selectSearchIconMarker = $('#iconmarker-style')\n    $selectLocationIconMarker = $('#locationmarker-style')\n\n    $.getJSON('static/dist/data/searchmarkerstyle.min.json').done(function (data) {\n        searchMarkerStyles = data\n        var searchMarkerStyleList = []\n\n        $.each(data, function (key, value) {\n            searchMarkerStyleList.push({\n                id: key,\n                text: value.name\n            })\n        })\n\n        $selectSearchIconMarker.select2({\n            placeholder: 'Select Icon Marker',\n            data: searchMarkerStyleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        $selectSearchIconMarker.on('change', function (e) {\n            var selectSearchIconMarker = $selectSearchIconMarker.val()\n            Store.set('searchMarkerStyle', selectSearchIconMarker)\n            updateSearchMarker(selectSearchIconMarker)\n        })\n\n        $selectSearchIconMarker.val(Store.get('searchMarkerStyle')).trigger('change')\n\n        updateSearchMarker(Store.get('lockMarker'))\n\n        $selectLocationIconMarker.select2({\n            placeholder: 'Select Location Marker',\n            data: searchMarkerStyleList,\n            minimumResultsForSearch: Infinity\n        })\n\n        $selectLocationIconMarker.on('change', function (e) {\n            Store.set('locationMarkerStyle', this.value)\n            updateLocationMarker(this.value)\n        })\n\n        $selectLocationIconMarker.val(Store.get('locationMarkerStyle')).trigger('change')\n    })\n\n    $selectGymMarkerStyle = $('#gym-marker-style')\n\n    $selectGymMarkerStyle.select2({\n        placeholder: 'Select Style',\n        minimumResultsForSearch: Infinity\n    })\n\n    $selectGymMarkerStyle.on('change', function (e) {\n        Store.set('gymMarkerStyle', this.value)\n        updateGymIcons()\n    })\n\n    $selectGymMarkerStyle.val(Store.get('gymMarkerStyle')).trigger('change')\n})\n\n$(function () {\n    function formatState(state) {\n        if (!state.id) {\n            return state.text\n        }\n        var $state = $(\n            '<span><i class=\"pokemon-sprite n' + state.element.value.toString() + '\"></i> ' + state.text + '</span>'\n        )\n        return $state\n    }\n\n    if (Store.get('startAtUserLocation')) {\n        centerMapOnLocation()\n    }\n\n    $.getJSON('static/dist/data/moves.min.json').done(function (data) {\n        moves = data\n    })\n\n    $selectExclude = $('#exclude-pokemon')\n    $selectPokemonNotify = $('#notify-pokemon')\n    $selectRarityNotify = $('#notify-rarity')\n    $textPerfectionNotify = $('#notify-perfection')\n    var numberOfPokemon = 493\n\n    // Load pokemon names and populate lists\n    $.getJSON('static/dist/data/pokemon.min.json').done(function (data) {\n        var pokeList = []\n\n        $.each(data, function (key, value) {\n            if (key > numberOfPokemon) {\n                return false\n            }\n            var _types = []\n            pokeList.push({\n                id: key,\n                text: i8ln(value['name']) + ' - #' + key\n            })\n            value['name'] = i8ln(value['name'])\n            value['rarity'] = i8ln(value['rarity'])\n            $.each(value['types'], function (key, pokemonType) {\n                _types.push({\n                    'type': i8ln(pokemonType['type']),\n                    'color': pokemonType['color']\n                })\n            })\n            value['types'] = _types\n            idToPokemon[key] = value\n        })\n\n        // setup the filter lists\n        $selectExclude.select2({\n            placeholder: i8ln('Select Pokmon'),\n            data: pokeList,\n            templateResult: formatState\n        })\n        $selectPokemonNotify.select2({\n            placeholder: i8ln('Select Pokmon'),\n            data: pokeList,\n            templateResult: formatState\n        })\n        $selectRarityNotify.select2({\n            placeholder: i8ln('Select Rarity'),\n            data: [i8ln('Common'), i8ln('Uncommon'), i8ln('Rare'), i8ln('Very Rare'), i8ln('Ultra Rare')]\n        })\n\n        // setup list change behavior now that we have the list to work from\n        $selectExclude.on('change', function (e) {\n            buffer = excludedPokemon\n            excludedPokemon = $selectExclude.val().map(Number)\n            buffer = buffer.filter(function (e) {\n                return this.indexOf(e) < 0\n            }, excludedPokemon)\n            reincludedPokemon = reincludedPokemon.concat(buffer)\n            clearStaleMarkers()\n            Store.set('remember_select_exclude', excludedPokemon)\n        })\n        $selectPokemonNotify.on('change', function (e) {\n            notifiedPokemon = $selectPokemonNotify.val().map(Number)\n            Store.set('remember_select_notify', notifiedPokemon)\n        })\n        $selectRarityNotify.on('change', function (e) {\n            notifiedRarity = $selectRarityNotify.val().map(String)\n            Store.set('remember_select_rarity_notify', notifiedRarity)\n        })\n        $textPerfectionNotify.on('change', function (e) {\n            notifiedMinPerfection = parseInt($textPerfectionNotify.val(), 10)\n            if (isNaN(notifiedMinPerfection) || notifiedMinPerfection <= 0) {\n                notifiedMinPerfection = ''\n            }\n            if (notifiedMinPerfection > 100) {\n                notifiedMinPerfection = 100\n            }\n            $textPerfectionNotify.val(notifiedMinPerfection)\n            Store.set('remember_text_perfection_notify', notifiedMinPerfection)\n        })\n\n        // recall saved lists\n        $selectExclude.val(Store.get('remember_select_exclude')).trigger('change')\n        $selectPokemonNotify.val(Store.get('remember_select_notify')).trigger('change')\n        $selectRarityNotify.val(Store.get('remember_select_rarity_notify')).trigger('change')\n        $textPerfectionNotify.val(Store.get('remember_text_perfection_notify')).trigger('change')\n\n        if (isTouchDevice() && isMobileDevice()) {\n            $('.select2-search input').prop('readonly', true)\n        }\n    })\n\n    // run interval timers to regularly update map and timediffs\n    window.setInterval(updateLabelDiffTime, 1000)\n    window.setInterval(updateMap, 5000)\n    window.setInterval(updateGeoLocation, 1000)\n\n    createUpdateWorker()\n\n    // Wipe off/restore map icons when switches are toggled\n    function buildSwitchChangeListener(data, dataType, storageKey) {\n        return function () {\n            Store.set(storageKey, this.checked)\n            if (this.checked) {\n                // When switch is turned on we asume it has been off, makes sure we dont end up in limbo\n                // Without this there could've been a situation where no markers are on map and only newly modified ones are loaded\n                if (storageKey === 'showPokemon') {\n                    lastpokemon = false\n                } else if (storageKey === 'showGyms') {\n                    lastgyms = false\n                } else if (storageKey === 'showPokestops') {\n                    lastpokestops = false\n                } else if (storageKey === 'showScanned') {\n                    lastslocs = false\n                } else if (storageKey === 'showSpawnpoints') {\n                    lastspawns = false\n                }\n                updateMap()\n            } else {\n                $.each(dataType, function (d, dType) {\n                    $.each(data[dType], function (key, value) {\n                        // for any marker you're turning off, you'll want to wipe off the range\n                        if (data[dType][key].marker.rangeCircle) {\n                            data[dType][key].marker.rangeCircle.setMap(null)\n                            delete data[dType][key].marker.rangeCircle\n                        }\n                        if (storageKey !== 'showRanges') data[dType][key].marker.setMap(null)\n                    })\n                    if (storageKey !== 'showRanges') data[dType] = {}\n                })\n                if (storageKey === 'showRanges') {\n                    updateMap()\n                }\n            }\n        }\n    }\n\n    // Setup UI element interactions\n    $('#gyms-switch').change(function () {\n        var options = {\n            'duration': 500\n        }\n        var wrapper = $('#gym-sidebar-wrapper')\n        if (this.checked) {\n            lastgyms = false\n            wrapper.show(options)\n        } else {\n            lastgyms = false\n            wrapper.hide(options)\n        }\n        var wrapper2 = $('#gyms-filter-wrapper')\n        if (this.checked) {\n            lastgyms = false\n            wrapper2.show(options)\n        } else {\n            lastgyms = false\n            wrapper2.hide(options)\n        }\n        buildSwitchChangeListener(mapData, ['gyms'], 'showGyms').bind(this)()\n    })\n    $('#pokemon-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['pokemons'], 'showPokemon').bind(this)()\n    })\n    $('#scanned-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['scanned'], 'showScanned').bind(this)()\n    })\n    $('#spawnpoints-switch').change(function () {\n        buildSwitchChangeListener(mapData, ['spawnpoints'], 'showSpawnpoints').bind(this)()\n    })\n    $('#ranges-switch').change(buildSwitchChangeListener(mapData, ['gyms', 'pokemons', 'pokestops'], 'showRanges'))\n\n    $('#pokestops-switch').change(function () {\n        var options = {\n            'duration': 500\n        }\n        var wrapper = $('#lured-pokestops-only-wrapper')\n        if (this.checked) {\n            lastpokestops = false\n            wrapper.show(options)\n        } else {\n            lastpokestops = false\n            wrapper.hide(options)\n        }\n        return buildSwitchChangeListener(mapData, ['pokestops'], 'showPokestops').bind(this)()\n    })\n\n    $('#sound-switch').change(function () {\n        Store.set('playSound', this.checked)\n    })\n\n    $('#geoloc-switch').change(function () {\n        $('#next-location').prop('disabled', this.checked)\n        $('#next-location').css('background-color', this.checked ? '#e0e0e0' : '#ffffff')\n        if (!navigator.geolocation) {\n            this.checked = false\n        } else {\n            Store.set('geoLocate', this.checked)\n        }\n    })\n\n    $('#lock-marker-switch').change(function () {\n        Store.set('lockMarker', this.checked)\n        searchMarker.setDraggable(!this.checked)\n    })\n\n    $('#search-switch').change(function () {\n        searchControl(this.checked ? 'on' : 'off')\n    })\n\n    $('#start-at-user-location-switch').change(function () {\n        Store.set('startAtUserLocation', this.checked)\n    })\n\n    $('#follow-my-location-switch').change(function () {\n        if (!navigator.geolocation) {\n            this.checked = false\n        } else {\n            Store.set('followMyLocation', this.checked)\n        }\n        locationMarker.setDraggable(!this.checked)\n    })\n\n    $('#scan-here-switch').change(function () {\n        if (this.checked && !Store.get('scanHereAlerted')) {\n            alert('Use this feature carefully ! This button will set the current map center as new search location. This may cause worker to teleport long range.')\n            Store.set('scanHereAlerted', true)\n        }\n        $('#scan-here').toggle(this.checked)\n        Store.set('scanHere', this.checked)\n    })\n\n    if ($('#nav-accordion').length) {\n        $('#nav-accordion').accordion({\n            active: 0,\n            collapsible: true,\n            heightStyle: 'content'\n        })\n    }\n\n    // Initialize dataTable in statistics sidebar\n    //   - turn off sorting for the 'icon' column\n    //   - initially sort 'name' column alphabetically\n\n    $('#pokemonList_table').DataTable({\n        paging: false,\n        searching: false,\n        info: false,\n        errMode: 'throw',\n        'language': {\n            'emptyTable': ''\n        },\n        'columns': [\n            { 'orderable': false },\n            null,\n            null,\n            null\n        ]\n    }).order([1, 'asc'])\n})"]}